{
  "id": "T098",
  "title": "Sessions (Option A): persisted sessions + create/list/show/resume/stop/fork/branch",
  "priority": 2,
  "status": "done",
  "details": "Implement a minimal session model that binds workspace + current sandbox + profile defaults, enabling resume/diagnose workflows. Option A: resume always provisions a fresh sandbox and rebinds the workspace (reuse existing workspace rebind code path).",
  "steps": [
    "DB: add sessions table (id, name, workspace_id, current_vmid, profile, branch, created_at, updated_at, meta_json) + indexes; add migration tests.",
    "Daemon: add endpoints for session create/list/show/resume/stop/fork/doctor (doctor can be stubbed until T100).",
    "Reuse JobOrchestrator.RebindWorkspace to implement resume; update session.current_vmid.",
    "CLI: add agentlab session create/list/show/resume/stop/fork/branch.",
    "Integrate with workspace leases so sessions reserve a workspace even while detached.",
    "Tests: session lifecycle tests (resume creates new sandbox, stop destroys sandbox but keeps workspace)."
  ],
  "blockers": [],
  "tags": [
    "prd-sessions",
    "api",
    "cli",
    "db",
    "workspaces"
  ],
  "files": [
    "internal/db/migrations.go",
    "internal/db/migrations_test.go",
    "internal/db/sessions.go",
    "internal/models/models.go",
    "internal/daemon/api.go",
    "internal/daemon/api_types.go",
    "internal/daemon/workspace_lease.go",
    "internal/daemon/api_sessions_test.go",
    "cmd/agentlab/api.go",
    "cmd/agentlab/commands.go",
    "cmd/agentlab/main.go",
    "cmd/agentlab/suggestions.go",
    "docs/faq.md"
  ],
  "depends_on": [
    "T091"
  ],
  "created_at": "2026-02-09T09:49:20Z",
  "updated_at": "2026-02-09T15:35:31Z"
}
